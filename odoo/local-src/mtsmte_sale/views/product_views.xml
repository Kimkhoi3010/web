<?xml version="1.0" encoding="UTF-8"?>
<odoo>

  <record id="product_template_form_view_specific" model="ir.ui.view">
    <field name="name">product.template.common.form.specific</field>
    <field name="model">product.template</field>
    <field name="inherit_id" ref="product.product_template_form_view"/>
    <field name="arch" type="xml">
      <xpath expr="//field[@name='purchase_ok']/.." position="after">
        <div>
          <field name="chemistry"/>
        </div>
      </xpath>
      <notebook position="inside">
        <page string="Substances to analyze" attrs="{'invisible': [('chemistry', '!=', 'chem')]}">
          <group>
            <field name="product_method_id"
                   context="{'default_product_id': active_id}"/>
            <field name="equipment_id"
                   context="{'default_product_ids': active_id}"/>
            <field name="product_extraction_type_id"
                   context="{'default_product_id': active_id}"/>
            <field name="legal_reference"/>
          </group>
          <group>
            <field name="product_substance_line_ids">
              <form>
                <field name="product_substance_id"/>
                <group>
                  <field name="sub_cas_number"/>
                  <field name="legal_limit_min"/>
                  <field name="product_uom_id"/>
                  <field name="legal_limit_max"/>
                  <field name="comments"/>
                </group>
                <group>
                  <field name="has_limit_min"/>
                  <field name="has_limit_max"/>
                </group>
                <group>
                  <field name="detection_limit"/>
                  <field name="quantification_limit"/>
                </group>
              </form>
              <tree>
                <field name="product_substance_id"/>
                <field name="sub_cas_number"/>
                <field name="legal_limit_min"/>
                <field name="product_uom_id"/>
                <field name="legal_limit_max"/>
                <field name="comments"/>
                <field name="has_limit_min"/>
                <field name="has_limit_max"/>
                <field name="detection_limit"/>
                <field name="quantification_limit"/>
              </tree>
            </field>
          </group>
        </page>
        <page string="Test Parameters" attrs="{'invisible': [('chemistry', 'not in', ('test_env','test_mec'))]}">
          <group>
              <field name="test_parameters"/>
          </group>
        </page>
        <page string="Results &amp; Observations"
              attrs="{'invisible': [('chemistry', 'not in', ('chem','test_env','test_mec'))]}">
          <group>
              <field name="results" nolabel="1"/>
          </group>
        </page>
      </notebook>
    </field>
  </record>

  <record id="product_method_action_tree" model="ir.actions.act_window">
      <field name="name">Methods</field>
      <field name="type">ir.actions.act_window</field>
      <field name="res_model">product.method</field>
      <field name="view_mode">tree,form</field>
  </record>

  <record id="product_extraction_type_action_tree" model="ir.actions.act_window">
      <field name="name">Extraction Types</field>
      <field name="type">ir.actions.act_window</field>
      <field name="res_model">product.extraction.type</field>
      <field name="view_mode">tree,form</field>
  </record>

</odoo>
