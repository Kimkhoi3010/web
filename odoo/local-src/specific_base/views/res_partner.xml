<?xml version="1.0" encoding="UTF-8"?>
<odoo>

    <record id="view_partner_title_tree" model="ir.ui.view">
        <field name="name">res.partner.title.tree</field>
        <field name="model">res.partner.title</field>
        <field name="inherit_id" ref="base.view_partner_title_tree"/>
        <field name="arch" type="xml">
            <field name="shortcut" position="after">
                <field name="active"/>
            </field>
        </field>
    </record>
    <record id="view_partner_title_form" model="ir.ui.view">
        <field name="name">res.partner.title.form</field>
        <field name="model">res.partner.title</field>
        <field name="inherit_id" ref="base.view_partner_title_form"/>
        <field name="arch" type="xml">
            <field name="shortcut" position="after">
                <field name="active"/>
            </field>
        </field>
    </record>

    <record id="view_partner_center_tree" model="ir.ui.view">
        <field name="name">res.partner.center.tree</field>
        <field name="model">res.partner</field>
        <field name="inherit_id" ref="base.view_partner_tree"/>
        <field name="priority">48</field>
        <field name="arch" type="xml">
            <field name="phone" position="attributes">
                <attribute name="invisible">1</attribute>
            </field>
            <field name="email" position="replace"/>
            <field name="phone" position="after">
                <field name="email"/>
                <field name="mobile" widget="phone"/>
                <field name="city"/>
                <field name="company_id"/>
            </field>

            <!--
            The active field will be added on an inherited view only for the group "specific_security.group_client_archive".
            The goal is to don't display "Archive" and "Dearchive" actions if we don't have the indicated group.
            -->
            <field name="active" position="replace"/>
        </field>
    </record>

    <record id="view_partner_center_tree_for_group_client_archive" model="ir.ui.view">
        <field name="name">res.partner.center.tree.for.group_client_archive</field>
        <field name="model">res.partner</field>
        <field name="inherit_id" ref="view_partner_center_tree"/>
        <field name="groups_id" eval="[(4, ref('specific_security.group_client_archive'))]"/>
        <field name="priority">100</field>
        <field name="arch" type="xml">

            <field name="parent_id" position="after">
                    <field name="active" invisible="1"/>
            </field>

        </field>
    </record>

    <record id="view_partner_center_form" model="ir.ui.view">
        <field name="name">res.partner.center.form</field>
        <field name="model">res.partner</field>
        <field name="inherit_id" ref="base.view_partner_form"/>
        <field name="priority">48</field>
        <field name="arch" type="xml">

            <field name="company_type" position="before">
                <group attrs="{'invisible': [('company_type', '!=', 'agency_customer')]}">
                    <field name="partner_planning_url" widget="url"/>
                </group>
            </field>

            <field name="company_type" position="after">
                <field name="company_type_visible" invisible="True"/>
            </field>
            <field name="company_type" position="attributes">
                <attribute name="attrs">{'invisible': [('company_type_visible', '=', False)]}</attribute>
            </field>

            <!-- disable duplicate button -->
            <xpath expr="//form" position="attributes">
                <attribute name="duplicate">0</attribute>
            </xpath>

            <xpath expr="//button[@name='toggle_active']" position="attributes">
                <attribute name="groups">specific_security.group_client_archive</attribute>
            </xpath>
            <!-- hide fields -->
            <field name="title" position="replace"/>
            <field name="fax" position="attributes">
                <attribute name="attrs">{'invisible': [('company_type', '=', 'agency_customer')]}</attribute>
            </field>
            <field name="category_id" position="attributes">
                <attribute name="attrs">{'invisible': [('company_type', '=', 'agency_customer')]}</attribute>
            </field>
            <field name="website" position="attributes">
                <attribute name="attrs">{'invisible': [('company_type', '=', 'agency_customer')]}</attribute>
            </field>
            <field name="function" position="attributes">
                <attribute name="attrs">{'invisible': [('company_type', '=', 'agency_customer')]}</attribute>
            </field>

            <field name="name" position="attributes">
                <attribute name="attrs">{
                    'readonly': [('company_type', '=', 'agency_customer')],
                    'required': [('company_type', '!=', 'agency_customer')],
                    'invisible': [('company_type', '=', 'agency_customer')],
                    }</attribute>
            </field>
            <field name="firstname" position="after">
                <field name="birthday"
                       attrs="{'required': [('company_type', '=', 'agency_customer')], 'invisible': [('company_type', '!=', 'agency_customer')]}"/>
            </field>
            <field name="email" position="attributes">
                <attribute name="attrs">{'required': [('company_type', '=', 'agency_customer')]}</attribute>
            </field>
            <field name="street" position="attributes">
                <attribute name="attrs">{'required': [('company_type', '=', 'agency_customer')]}</attribute>
            </field>
            <field name="city" position="attributes">
                <attribute name="attrs">{'required': [('company_type', '=', 'agency_customer')]}</attribute>
            </field>
            <field name="zip" position="attributes">
                <attribute name="attrs">{'required': [('company_type', '=', 'agency_customer')]}</attribute>
            </field>
            <field name="mobile" position="attributes">
                <attribute name="attrs">{'required': [('company_type', '=', 'agency_customer')]}</attribute>
            </field>
            <field name="firstname" position="attributes">
                <attribute name="attrs">{'required': [('company_type', '=', 'agency_customer')], 'invisible': [('company_type', '!=', 'agency_customer')]}</attribute>
            </field>
            <field name="lastname" position="attributes">
                <attribute name="attrs">{'required': [('company_type', '=', 'agency_customer')], 'invisible': [('company_type', '!=', 'agency_customer')]}</attribute>
            </field>

            <field name="opt_out" position="replace"/>
            <field name="phone" position="before">
                <field name="opt_out" string="Mailing Opt-Out"/>
                <field name="provenance" attrs="{'invisible': [('company_type', '!=', 'agency_customer')]}"/>
            </field>
            <field name="lastname" position="before">
                <field name="phototherapist_id"
                       attrs="{'required': [('company_type', '=', 'agency_customer')], 'invisible': [('company_type', '!=', 'agency_customer')]}"/>
                <field name="title"
                       attrs="{'required': [('company_type', '=', 'agency_customer')], 'invisible': [('company_type', '!=', 'agency_customer')]}"/>
            </field>
            <xpath expr="//div[@class='oe_title']/div[@class='oe_edit_only']" position="attributes">
                <attribute name="class"></attribute>
            </xpath>
            <field name="company_id" position="attributes">
                <attributes name="groups">base.group_multi_company</attributes>
            </field>

            <xpath expr="//page[@name='sales_purchases']" position="inside">
                <group string="Marketing">
                    <field name="can_edit_marketing_values" invisible="True"/>
                    <field name="campaign_id" attrs="{'readonly': [('can_edit_marketing_values', '=', False)]}"/>
                    <field name="medium_id" attrs="{'readonly': [('can_edit_marketing_values', '=', False)]}"/>
                    <field name="source_id" attrs="{'readonly': [('can_edit_marketing_values', '=', False)]}"/>
                </group>
            </xpath>

            <!-- Hide the contacts addresses tab -->
            <xpath expr="//page[//field[@name='child_ids']]" position="attributes">
                <attribute name="groups">specific_security.group_can_see_more_pages_on_partner</attribute>
            </xpath>
            <xpath expr="//page[@name='sales_purchases']" position="attributes">
                <attribute name="groups">specific_security.group_can_see_more_pages_on_partner</attribute>
            </xpath>
            <xpath expr="//notebook/page[@name='internal_notes']" position="before">
                <page name="more_infos" string="Extra Infos" attrs="{'invisible': [('company_type', '!=', 'agency_customer')]}">
                    <group>
                        <group>
                            <field name="function"/>
                            <field name="info_meeting_date"/>
                            <field name="flash_done"/>
                            <field name="flash_test_date" attrs="{'required': [('flash_done', '=', 'y')]}"/>
                            <field name="flash_test_zone" attrs="{'required': [('flash_done', '=', 'y')]}"/>
                            <field name="flash_test_setting" attrs="{'required': [('flash_done', '=', 'y')]}"/>
                            <field name="socio_professional_category"/>
                            <field name="family_situation"/>
                            <field name="children_nb"/>
                            <field name="why_no_buy"/>
                            <field name="maximum_budget"/>
                            <field name="beauty_institute_attented"/>
                        </group>
                        <group>
                            <label for="comment1" colspan="2"/>
                            <field name="comment1" nolabel="1" colspan="2"/>
                            <label for="comment2" colspan="2"/>
                            <field name="comment2" nolabel="1" colspan="2"/>
                            <label for="comment3" colspan="2"/>
                            <field name="comment3" nolabel="1" colspan="2"/>
                            <field name="coffret_date_remise"/>
                        </group>
                    </group>
                </page>
                <page name="survey" string="Diagnostic" attrs="{'invisible': [('company_type', '!=', 'agency_customer')]}">
                    <button name="take_me_to_diagnostic_survey" type="object" string="Fill Diagnostic" class="oe_highlight"/>
                    <group name="survey_answers" string="Answers">
                        <field name="survey_input_lines">
                            <tree>
                                <field name="survey_id"/>
                                <field name="question_id"/>
                                <field name="value_suggested_row"/>
                                <field name="value_suggested"/>
                            </tree>
                        </field>
                    </group>
                </page>
                <page name="sales_invoices" string="Sales / Invoices" attrs="{'invisible': [('company_type', '!=', 'agency_customer')]}">
                    <group name="sales" string="Sales">
                        <field name="sale_order_ids" nolabel="1"/>
                    </group>
                    <group name="invoices" string="Invoices" attrs="{'invisible': [('company_type', '!=', 'agency_customer')]}">
                        <field name="invoice_ids" nolabel="1"/>
                    </group>
                </page>
                <page name="meetings" string="Meetings" attrs="{'invisible': [('company_type', '!=', 'agency_customer')]}">
                    <field name="meeting_ids" nolabel="1"/>
                </page>
            </xpath>


        </field>
    </record>

    <record id="view_partner_center_form_2" model="ir.ui.view">
        <field name="name">res.partner.center.form.2</field>
        <field name="model">res.partner</field>
        <field name="inherit_id" ref="account.view_partner_property_form"/>
        <field name="priority">48</field>
        <field name="arch" type="xml">

            <xpath expr="//page[@name='accounting']" position="attributes">
                <attribute name="groups">specific_security.group_can_see_more_pages_on_partner</attribute>
            </xpath>

        </field>
    </record>

</odoo>
