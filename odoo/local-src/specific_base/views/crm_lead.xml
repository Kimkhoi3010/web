<?xml version="1.0" encoding="UTF-8"?>
<odoo>

    <record model="ir.ui.view" id="view_crm_lead_specific_form">
        <field name="name">crm.lead.specific.form</field>
        <field name="model">crm.lead</field>
        <field name="inherit_id" ref="crm.crm_case_form_view_oppor"/>
        <field name="arch" type="xml">

            <button name="action_set_won" position="after">
                <button name="%(action_crm_opportunity_to_customer)d" string="Convert to Customer" type="action"
                        help="Convert to Customer" class="oe_highlight"
                        attrs="{'invisible': [('partner_id', '!=', False)]}"/>
            </button>

            <div class="oe_title" position="after">
                <group>
                    <group>
                        <field name="lead_planning_url" widget="url"/>
                    </group>
                </group>
            </div>

            <label for="contact_name" position="before">
                <field name="phototherapist_id" options="{'no_create': True}"/>
            </label>

            <field name="partner_id" position="attributes">
                <attribute name="readonly">True</attribute>
            </field>

            <field name="partner_name" position="attributes">
                <attribute name="invisible">True</attribute>
            </field>

            <field name="fax" position="attributes">
                <attribute name="invisible">True</attribute>
            </field>

            <field name="user_id" position="before">
                <field name="can_edit_user" invisible="True"/>
            </field>

            <field name="campaign_id" position="before">
                <field name="company_id"
                       groups="base.group_multi_company"
                       options="{'no_create': True}"/>
            </field>

            <field name="date_action" position="attributes">
                <attribute name="invisible">True</attribute>
            </field>

            <field name="date_action" position="after">
                <field name="datetime_action" attrs="{'invisible': [('next_activity_id', '=', False)]}" placeholder="Choose a date..."/>
            </field>

            <notebook position="inside">
                <page string="B2B">
                    <group>
                        <field name="opening_date"/>
                        <field name="opening_location"/>
                        <field name="opening_country_id"/>
                        <field name="personal_contribution"/>
                        <field name="graduate_education"/>
                        <field name="has_franchisee"/>
                    </group>
                </page>
            </notebook>

            <xpath expr="//field[@name='campaign_id']" position="before">
                <field name="can_edit_marketing_values" invisible="True"/>
            </xpath>
            <xpath expr="//field[@name='campaign_id']" position="attributes">
                <attribute name="options">{'no_create': True}</attribute>
                <attribute name="attrs">{'readonly': [('can_edit_marketing_values', '=', False)]}</attribute>
            </xpath>

            <xpath expr="//field[@name='medium_id']" position="attributes">
                <attribute name="options">{'no_create': True}</attribute>
                <attribute name="attrs">{'readonly': [('can_edit_marketing_values', '=', False)]}</attribute>
            </xpath>

            <xpath expr="//field[@name='source_id']" position="attributes">
                <attribute name="options">{'no_create': True}</attribute>
                <attribute name="attrs">{'readonly': [('can_edit_marketing_values', '=', False)]}</attribute>
            </xpath>

            <!-- All customer fields are readonly when customer is linked/created -->
            <field name="contact_name" position="attributes">
                <attribute name="attrs">{'readonly':[('partner_id','!=',False)]}</attribute>
            </field>

            <field name="phototherapist_id" position="attributes">
                <attribute name="attrs">{'readonly':[('partner_id','!=',False)]}</attribute>
            </field>
            <field name="title" position="attributes">
                <attribute name="attrs">{'readonly':[('partner_id','!=',False)]}</attribute>
            </field>

            <field name="street" position="attributes">
                <attribute name="attrs">{'readonly':[('partner_id','!=',False)]}</attribute>
            </field>
            <field name="street2" position="attributes">
                <attribute name="attrs">{'readonly':[('partner_id','!=',False)]}</attribute>
            </field>
            <field name="zip" position="attributes">
                <attribute name="attrs">{'readonly':[('partner_id','!=',False)]}</attribute>
            </field>
            <field name="city" position="attributes">
                <attribute name="attrs">{'readonly':[('partner_id','!=',False)]}</attribute>
            </field>
            <field name="state_id" position="attributes">
                <attribute name="attrs">{'readonly':[('partner_id','!=',False)]}</attribute>
            </field>
            <field name="country_id" position="attributes">
                <attribute name="attrs">{'readonly':[('partner_id','!=',False)]}</attribute>
            </field>

            <field name="function" position="attributes">
                <attribute name="attrs">{'readonly':[('partner_id','!=',False)]}</attribute>
            </field>
            <field name="phone" position="attributes">
                <attribute name="attrs">{'readonly':[('partner_id','!=',False)]}</attribute>
            </field>
            <field name="mobile" position="attributes">
                <attribute name="attrs">{'readonly':[('partner_id','!=',False)]}</attribute>
            </field>
            <field name="email_from" position="attributes">
                <attribute name="attrs">{'readonly':[('partner_id','!=',False)]}</attribute>
            </field>

            <field name="user_id" position="attributes">
                <attribute name="attrs">{'readonly':['|', ('can_edit_user','=',False), ('partner_id','!=',False)]}</attribute>
            </field>
            <field name="team_id" position="attributes">
                <attribute name="attrs">{'readonly':[('partner_id','!=',False)]}</attribute>
            </field>

        </field>
    </record>

    <record model="ir.ui.view" id="view_crm_lead_case_form_specific_form">
        <field name="name">crm.lead.case.form.specific.form</field>
        <field name="model">crm.lead</field>
        <field name="inherit_id" ref="crm.crm_case_form_view_leads"/>
        <field name="arch" type="xml">

            <button name="%(crm.action_crm_lead2opportunity_partner)d" position="attributes">
                <attribute name="invisible">True</attribute>
            </button>

            <button name="%(crm.action_crm_lead2opportunity_partner)d" position="after">
                <button name="convert_to_opportunity" string="Convert to Opportunity" type="object"
                        help="Convert to Opportunity" class="oe_highlight"
                        attrs="{'invisible': [('type','!=','lead'), ('type','!=',False)]}"/>
            </button>

            <div class="oe_title" position="after">
                <group>
                    <group>
                        <field name="lead_planning_url" widget="url"/>
                    </group>
                </group>
            </div>

            <label for="contact_name" position="before">
                <field name="phototherapist_id" options="{'no_create': True}"/>
            </label>

            <field name="partner_id" position="attributes">
                <attribute name="readonly">True</attribute>
            </field>

            <field name="partner_name" position="attributes">
                <attribute name="invisible">True</attribute>
            </field>

            <field name="fax" position="attributes">
                <attribute name="invisible">True</attribute>
            </field>

            <field name="user_id" position="before">
                <field name="can_edit_user" invisible="True"/>
            </field>
            <field name="user_id" position="attributes">
                <attribute name="attrs">{'readonly':[('can_edit_user','=',False)]}</attribute>
            </field>

            <notebook position="inside">
                <page string="B2B">
                    <group>
                        <field name="opening_date"/>
                        <field name="opening_location"/>
                        <field name="opening_country_id"/>
                        <field name="personal_contribution"/>
                        <field name="graduate_education"/>
                        <field name="has_franchisee"/>
                    </group>
                </page>
            </notebook>

            <field name="company_id" position="attributes">
                <attribute name="required">True</attribute>
            </field>

            <xpath expr="//field[@name='campaign_id']" position="before">
                <field name="can_edit_marketing_values" invisible="True"/>
            </xpath>
            <xpath expr="//field[@name='campaign_id']" position="attributes">
                <attribute name="options">{'no_create': True}</attribute>
                <attribute name="attrs">{'readonly': [('can_edit_marketing_values', '=', False)]}</attribute>
            </xpath>

            <xpath expr="//field[@name='medium_id']" position="attributes">
                <attribute name="options">{'no_create': True}</attribute>
                <attribute name="attrs">{'readonly': [('can_edit_marketing_values', '=', False)]}</attribute>
            </xpath>

            <xpath expr="//field[@name='source_id']" position="attributes">
                <attribute name="options">{'no_create': True}</attribute>
                <attribute name="attrs">{'readonly': [('can_edit_marketing_values', '=', False)]}</attribute>
            </xpath>

            <!-- All customer fields are readonly when customer is linked/created -->
            <field name="contact_name" position="attributes">
                <attribute name="attrs">{'readonly':[('partner_id','!=',False)]}</attribute>
            </field>

            <field name="phototherapist_id" position="attributes">
                <attribute name="attrs">{'readonly':[('partner_id','!=',False)]}</attribute>
            </field>
            <field name="title" position="attributes">
                <attribute name="attrs">{'readonly':[('partner_id','!=',False)]}</attribute>
            </field>

            <field name="street" position="attributes">
                <attribute name="attrs">{'readonly':[('partner_id','!=',False)]}</attribute>
            </field>
            <field name="street2" position="attributes">
                <attribute name="attrs">{'readonly':[('partner_id','!=',False)]}</attribute>
            </field>
            <field name="zip" position="attributes">
                <attribute name="attrs">{'readonly':[('partner_id','!=',False)]}</attribute>
            </field>
            <field name="city" position="attributes">
                <attribute name="attrs">{'readonly':[('partner_id','!=',False)]}</attribute>
            </field>
            <field name="state_id" position="attributes">
                <attribute name="attrs">{'readonly':[('partner_id','!=',False)]}</attribute>
            </field>
            <field name="country_id" position="attributes">
                <attribute name="attrs">{'readonly':[('partner_id','!=',False)]}</attribute>
            </field>

            <field name="function" position="attributes">
                <attribute name="attrs">{'readonly':[('partner_id','!=',False)]}</attribute>
            </field>
            <field name="phone" position="attributes">
                <attribute name="attrs">{'readonly':[('partner_id','!=',False)]}</attribute>
            </field>
            <field name="mobile" position="attributes">
                <attribute name="attrs">{'readonly':[('partner_id','!=',False)]}</attribute>
            </field>
            <field name="email_from" position="attributes">
                <attribute name="attrs">{'readonly':[('partner_id','!=',False)]}</attribute>
            </field>

            <field name="user_id" position="attributes">
                <attribute name="attrs">{'readonly':['|', ('can_edit_user','=',False), ('partner_id','!=',False)]}</attribute>
            </field>
            <field name="team_id" position="attributes">
                <attribute name="attrs">{'readonly':[('partner_id','!=',False)]}</attribute>
            </field>

        </field>
    </record>

    <record model="ir.ui.view" id="view_sale_crm_lead_specific_form">
        <field name="name">sale.crm.lead.specific.form</field>
        <field name="model">crm.lead</field>
        <field name="inherit_id" ref="sale_crm.crm_case_form_view_oppor"/>
        <field name="arch" type="xml">

            <button name="%(sale_crm.sale_action_quotations_new)d" position="attributes">
                <attribute name="context">
                    {'search_default_partner_id': partner_id, 'default_partner_id': partner_id, 'default_team_id': team_id, 'default_phototherapist_id': phototherapist_id}
                </attribute>
            </button>

        </field>
    </record>

    <record model="ir.ui.view" id="view_crm_lead_case_form_specific_form_group">
        <field name="name">crm.lead.specific.form</field>
        <field name="model">crm.lead</field>
        <field name="inherit_id" ref="crm.crm_case_form_view_leads"/>
        <field name="groups_id" eval="[(6, 0, [ref('specific_security.grp_centers'), ref('specific_security.grp_center_managers')])]"/>
        <field name="arch" type="xml">
            <field name="company_id" position="attributes">
                <attribute name="readonly">1</attribute>
            </field>
            <field name="referred" position="attributes">
                <attribute name="readonly">1</attribute>
            </field>
        </field>
    </record>

    <record model="ir.ui.view" id="view_crm_lead_form_specific_form_group">
        <field name="name">crm.lead.form.specific.form</field>
        <field name="model">crm.lead</field>
        <field name="inherit_id" ref="specific_base.view_crm_lead_specific_form"/>
        <field name="groups_id" eval="[(6, 0, [ref('specific_security.grp_centers'), ref('specific_security.grp_center_managers')])]"/>
        <field name="arch" type="xml">
            <field name="campaign_id" position="before">
                <field name="company_id"
                       groups="base.group_multi_company"
                       options="{'no_create': True}"
                       readonly="True"/>
            </field>
            <field name="referred" position="attributes">
                <attribute name="readonly">1</attribute>
            </field>
        </field>
    </record>

    <record model="ir.ui.view" id="view_crm_lead_specific_tree">
        <field name="name">crm.lead.specific.tree</field>
        <field name="model">crm.lead</field>
        <field name="inherit_id" ref="crm.crm_case_tree_view_oppor"/>
        <field name="arch" type="xml">

            <field name="date_action" position="attributes">
                <attribute name="invisible">True</attribute>
            </field>

            <field name="date_action" position="after">
                <field name="datetime_action"/>
            </field>

        </field>
    </record>

    <record model="ir.ui.view" id="view_crm_lead_tag_specific_form">
        <field name="name">crm.lead.tag.specific.form</field>
        <field name="model">crm.lead.tag</field>
        <field name="inherit_id" ref="crm.crm_lead_tag_form"/>
        <field name="arch" type="xml">

            <field name="name" position="after">
                <field name="slug"/>
            </field>

        </field>
    </record>

    <record model="ir.ui.view" id="view_crm_lead_tag_specific_tree">
        <field name="name">crm.lead.tag.specific.tree</field>
        <field name="model">crm.lead.tag</field>
        <field name="inherit_id" ref="crm.crm_lead_tag_tree"/>
        <field name="arch" type="xml">

            <field name="name" position="after">
                <field name="slug"/>
            </field>

        </field>
    </record>

    <record model="ir.ui.view" id="view_crm_lead_tag_specific_search">
        <field name="name">crm.lead.tag.specific.search</field>
        <field name="model">crm.lead.tag</field>
        <field name="arch" type="xml">

            <search string="Search lead tag">
                <field name="name"/>
                <field name="slug"/>
            </search>

        </field>
    </record>

    <record id="crm.crm_lead_opportunities_tree_view" model="ir.actions.act_window">
        <field name="context">{'default_type': 'opportunity', 'default_user_id': uid}</field>
    </record>

    <record id="crm.crm_lead_action_activities" model="ir.actions.act_window">
        <field name="context">{'default_type': 'opportunity', 'default_user_id': uid}</field>
    </record>

</odoo>
